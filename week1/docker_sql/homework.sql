SELECT
	COUNT(*) AS NO_OF_TRIPS_UP_TO_1MILE
FROM
	GREEN_TAXI_DATA
WHERE
	LPEP_DROPOFF_DATETIME >= '2019-10-01 00:00:00'
	AND LPEP_DROPOFF_DATETIME < '2019-11-01 00:00:00'
	AND TRIP_DISTANCE <= 1;
	
SELECT
	COUNT(*) AS NO_OF_TRIPS_BTW_1MILE_AND_3MILE
FROM
	GREEN_TAXI_DATA
WHERE
	LPEP_DROPOFF_DATETIME >= '2019-10-01 00:00:00'
	AND LPEP_DROPOFF_DATETIME < '2019-11-01 00:00:00'
	AND TRIP_DISTANCE > 1
	AND TRIP_DISTANCE <= 3;
	
SELECT
	COUNT(*) AS NO_OF_TRIPS_BTW_3MILES_AND_7MILES
FROM
	GREEN_TAXI_DATA
WHERE
	LPEP_DROPOFF_DATETIME >= '2019-10-01 00:00:00'
	AND LPEP_DROPOFF_DATETIME < '2019-11-01 00:00:00'
	AND TRIP_DISTANCE > 3
	AND TRIP_DISTANCE <= 7;
	
SELECT
	COUNT(*) AS NO_OF_TRIPS_BTW_7MILES_AND_10MILES
FROM
	GREEN_TAXI_DATA
WHERE
	LPEP_DROPOFF_DATETIME >= '2019-10-01 00:00:00'
	AND LPEP_DROPOFF_DATETIME < '2019-11-01 00:00:00'
	AND TRIP_DISTANCE > 7
	AND TRIP_DISTANCE <= 10;
	
SELECT
	COUNT(*) AS NO_OF_TRIPS_OVER_10MILES
FROM
	GREEN_TAXI_DATA
WHERE
	LPEP_DROPOFF_DATETIME >= '2019-10-01 00:00:00'
	AND LPEP_DROPOFF_DATETIME < '2019-11-01 00:00:00'
	AND TRIP_DISTANCE > 10;
	
SELECT
	LPEP_PICKUP_DATETIME,
	MAX(TRIP_DISTANCE) AS LONGEST_TRIP
FROM
	GREEN_TAXI_DATA
GROUP BY
	1
ORDER BY
	2 DESC
LIMIT
	1;
	
SELECT
	Z."Zone",
	SUM(G.TOTAL_AMOUNT) AS TOTAL_AMOUNT
FROM
	GREEN_TAXI_DATA G
	JOIN TAXI_ZONES Z ON G."PULocationID" = Z."LocationID"
WHERE
	G.LPEP_PICKUP_DATETIME >= '2019-10-18 00:00:00'
	AND G.LPEP_PICKUP_DATETIME < '2019-10-19 00:00:00'
GROUP BY
	Z."Zone"
HAVING
	SUM(G.TOTAL_AMOUNT) > 13000
ORDER BY
	SUM(G.TOTAL_AMOUNT) DESC;

SELECT
	G.TIP_AMOUNT,
	ZDO."Zone"
FROM
	GREEN_TAXI_DATA G
	JOIN TAXI_ZONES ZPO ON G."PULocationID" = ZPO."LocationID"
	JOIN TAXI_ZONES ZDO ON G."DOLocationID" = ZDO."LocationID"
WHERE
	G.LPEP_PICKUP_DATETIME >= '2019-10-18 00:00:00'
	AND G.LPEP_PICKUP_DATETIME < '2019-11-1 00:00:00'
	AND ZPO."Zone" = 'East Harlem North'
ORDER BY
	1 DESC
LIMIT
	1;